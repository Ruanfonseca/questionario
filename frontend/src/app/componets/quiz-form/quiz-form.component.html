<div class="col-md-12 d-flex align-items-center justify-content-center p-1">
  <form class="bg-light col-md-6 col-sm-12  p-3" [formGroup]="questionarioForm" (ngSubmit)="submitQuestionario()">
    <div class="form-group">
      <div class="input-group mb-3">
        <span class="input-group-text" id="titulo">Titulo</span>
        <input type="text" class="form-control" id="titulo" name="titulo" formControlName="titulo" required>
      </div>
      <div class="input-group mb-3">
        <input type="number" class="form-control" id="tempo_duracao" name="tempo_duracao"
          formControlName="tempo_duracao" required>
        <span class="input-group-text" id="tempo_duracao">Tempo de Duração (Min)</span>
      </div>
      <div class="input-group mb-3">
        <span class="input-group-text" id="tempo_disponivel">Tempo Disponível (Min)</span>
        <input type="number" class="form-control" id="tempo_disponivel" name="tempo_disponivel"
          formControlName="tempo_disponivel" required>
      </div>
      <div class="input-group mb-3">
        <span class="input-group-text">Dificuldade</span>
        <select class="form-select col-md-4" aria-label="dificuldade" formControlName="dificuldade" required>
          <option value="Fácil" selected>Fácil</option>
          <option value="Mediano">Mediano</option>
          <option value="Difícil">Difícil</option>
        </select>
        <span class="input-group-text" id="qtd_questoes">Numero de Questões</span>
        <input type="text" class="form-control" formControlName="qtd_questoes" readonly>

      </div>
    </div>

    <div formGroupName="tema">
      <div>
        <label for="temaid">Tema</label>
        <select id="temaid" name="temaid" class="form-control mb-3" formControlName="id" required
          (click)="alterarTema()">
          <ng-container *ngFor="let tema of temas; let t = index">
            <option *ngIf="t == 0" [attr.selected]="true" value="{{tema.id}}">
              {{tema.nome}}
            </option>
            <option *ngIf="t!= 0" value="{{tema.id}}" [disabled]="questoes.length>0">
              {{tema.nome}}
            </option>
          </ng-container>
        </select>
      </div>

      <div class="form-inline btn-group">
        <div class="dropdown">
          <button type="button" class="btn btn-primary dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false" (click)="obterPorTema()" [disabled]="!tema.get('id')?.value">
            Adicionar Questão</button>
          <div class="dropdown-menu scrollable-menu pr-3" aria-labelledby="dropdownMenuButton">
            <div *ngIf="questoes_drop.length>=1; else elseBlock">
              <div *ngFor="let questao of questoes_drop; let j = index;">
                <div>
                  <span class="dropdown-item m-2 p-2" (click)="addQuestaoComp(questao)"> {{questao.texto}}</span>
                </div>
              </div>
            </div>
            <ng-template #elseBlock>
              <span class="dropdown-item m-2 p-2"> O Tema Não Possui Questões!</span>
            </ng-template>
          </div>
        </div>

        <div class="dropdown ml-2">
          <button type="button" class="btn btn-primary dropdown-toggle" id="dropdownQuest" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" (click)="obterPorTema()" [disabled]="!tema.get('id')?.value">
          Adicionar Questões
          </button>
          <div class="dropdown-menu p-4">
            <div class="mb-3">
              <input type="number" class="form-control" id="qtdQuest" min="0" max="{{questoes_drop.length -  questoes.length}}" placeholder="Quantidade de Questões" [formControl]="questaoQtdForm">
            </div>
            <button type="button" class="btn btn-primary float-right" (click)="addRandonQuest()" [disabled]="questoes_drop.length - questoes.length <1">Adicionar</button>
          </div>
        </div>

      </div>

    </div>

    <div formArrayName="questoes" *ngIf="questoes.length>0">
      <h2 class="title pt-3">Questoes</h2>
      <div *ngFor="let questao of questoes.controls; let j = index">
        <div class="form-group" [formGroupName]="j">
          <ul class="list-group">
            <li class="list-group-item">
              <button type="button" class="btn-danger btn" (click)="deleteQuestao(j)">x</button>
              <span class="pl-3">{{questao.get('nome')?.value}}</span>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <div class="form-group mt-3">
      <button class="btn-primary form-control" type="submit">{{ btnText }}</button>
    </div>
  </form>

</div>

<div class="p-4">
  <mat-progress-bar *ngIf="!progress" mode="indeterminate"></mat-progress-bar>
</div>
